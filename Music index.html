<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8"/>
  <title>Vibe – Your Music World</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"/>
  <meta name="theme-color" content="#1DB954"/>
  <link rel="manifest" href="manifest.json"/>
  <link rel="stylesheet" href="css/styles.css"/>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
  <script src="https://unpkg.com/phosphor-icons"></script>
</head>
<body>
  <main id="root">
    <!-- injected by ui.js -->
  </main>

  <!-- mini-player bar (always visible) -->
  <aside id="mini-player" hidden>
    <img id="mini-art" alt=""/>
    <div>
      <span id="mini-title"></span>
      <span id="mini-artist"></span>
    </div>
    <button id="mini-play"><i class="ph-play-fill"></i></button>
  </aside>

  <!-- full-screen player overlay -->
  <section id="player-overlay" hidden>
    <nav>
      <button id="close-player"><i class="ph-caret-down-bold"></i></button>
      <span>Now Playing</span>
      <button id="toggle-lyrics"><i class="ph-microphone-stage-bold"></i></button>
    </nav>
    <img id="player-art" alt=""/>
    <h1 id="player-title"></h1>
    <p id="player-artist"></p>
    <div id="progress-wrapper">
      <input type="range" id="progress" min="0" step="1" value="0"/>
      <div id="time"><span id="current">0:00</span><span id="duration">0:00</span></div>
    </div>
    <div id="transport">
      <button id="shuffle"><i class="ph-shuffle-bold"></i></button>
      <button id="prev"><i class="ph-skip-back-fill"></i></button>
      <button id="play-pause"><i class="ph-play-fill"></i></button>
      <button id="next"><i class="ph-skip-forward-fill"></i></button>
      <button id="repeat"><i class="ph-repeat-bold"></i></button>
    </div>
    <section id="lyrics-panel" hidden>
      <button id="close-lyrics"><i class="ph-x-bold"></i></button>
      <h2>Lyrics</h2>
      <pre id="lyrics-text"></pre>
    </section>
  </section>

  <!-- Bottom navigation -->
  <nav id="bottom-nav">
    <button class="nav-btn active" data-route="home"><i class="ph-house-fill"></i><span>Home</span></button>
    <button class="nav-btn" data-route="search"><i class="ph-magnifying-glass-bold"></i><span>Search</span></button>
    <button class="nav-btn" data-route="library"><i class="ph-books-fill"></i><span>Library</span></button>
  </nav>

  <audio id="audio" preload="metadata"></audio>

  <script type="module" src="js/app.js"></script>
</body>
        </html>
        {
  "name": "Vibe – Your Music World",
  "short_name": "Vibe",
  "description": "A Spotify-like PWA for your music.",
  "start_url": "./index.html",
  "display": "standalone",
  "background_color": "#000",
  "theme_color": "#1DB954",
  "icons": [
    { "src": "assets/icon-192.png", "sizes": "192x192", "type": "image/png" },
    { "src": "assets/icon-512.png", "sizes": "512x512", "type": "image/png" }
  ]
}
const CACHE = 'vibe-v1';
const FILES = [
  './',
  './index.html',
  './css/styles.css',
  './js/app.js',
  './js/player.js',
  './js/ui.js',
  './js/db.js',
  './manifest.json'
];

self.addEventListener('install', e => e.waitUntil(caches.open(CACHE).then(c => c.addAll(FILES))));
self.addEventListener('fetch', e => e.respondWith(caches.match(e.request).then(r => r || fetch(e.request))));
:root{
  --primary:#1DB954;
  --bg:#000;
  --surface:#121212;
  --card:#181818;
  --text:#fff;
  --sub:#b3b3b3;
  --font:'Montserrat',sans-serif;
}
*{margin:0;padding:0;box-sizing:border-box}
body{background:var(--bg);color:var(--text);font-family:var(--font);-webkit-tap-highlight-color:transparent}
#root{min-height:100vh;padding:70px 12px 90px}
#bottom-nav{position:fixed;bottom:0;width:100%;display:flex;background:linear-gradient(to top,var(--bg),rgba(0,0,0,.9));padding:8px 0;z-index:10}
.nav-btn{flex:1;display:flex;flex-direction:column;align-items:center;color:var(--sub);background:none;border:none;font-size:10px;cursor:pointer}
.nav-btn.active{color:var(--text)}
.nav-btn i{font-size:26px;margin-bottom:2px}

/* mini-player */
#mini-player{position:fixed;bottom:70px;left:0;right:0;height:60px;background:var(--card);display:flex;align-items:center;padding:0 12px;z-index:9}
#mini-art{width:46px;height:46px;border-radius:4px;margin-right:12px}
#mini-title{font-size:14px;font-weight:600}
#mini-artist{font-size:12px;color:var(--sub)}
#mini-play{margin-left:auto;background:none;border:none;color:var(--text);font-size:26px}

/* player overlay */
#player-overlay{position:fixed;inset:0;background-size:cover;background-position:center;z-index:20;display:flex;flex-direction:column;justify-content:space-between;padding:20px}
#player-overlay nav{display:flex;justify-content:space-between;align-items:center}
#player-art{width:80%;max-width:350px;border-radius:12px;margin:0 auto}
#progress-wrapper{margin:20px 0}
#progress{width:100%;accent-color:var(--primary)}
#time{display:flex;justify-content:space-between;font-size:12px;color:var(--sub)}
#transport{display:flex;justify-content:space-around;align-items:center;font-size:28px}
#transport button{background:none;border:none;color:var(--text)}
#lyrics-panel{position:absolute;inset:0;background:var(--surface);padding:20px;overflow-y:auto}
export const songs = [
  { id:1, title:"Kesariya", artist:"Arijit Singh", album:"Brahmastra",
    artwork:"https://c.saavncdn.com/822/Kesariya-From-Brahmastra-Hindi-2022-20220717092020-500x500.jpg",
    audio:"https://www.pagalworld.com.se/files/download/id/66895" },
  { id:2, title:"Apna Bana Le", artist:"Arijit Singh", album:"Bhediya",
    artwork:"https://c.saavncdn.com/136/Apna-Bana-Le-From-Bhediya-Hindi-2022-20221105151000-500x500.jpg",
    audio:"https://www.pagalworld.com.se/files/download/id/68138" },
  { id:3, title:"Kal Ho Naa Ho", artist:"Sonu Nigam",
    artwork:"https://c.saavncdn.com/593/Kal-Ho-Naa-Ho-Hindi-2003-20190329183354-500x500.jpg",
    audio:"https://www.pagalworld.com.se/files/download/id/2965" }
];

export const lyrics = {
  1:`[00:16.52] मुझको इतना बताये कोई\n[00:20.52] कैसे तुझसे दिल ना लगाये कोई`,
  2:`[00:28.10] तू मेरा कोई ना\n[00:31.55] होके भी कुछ लागे`,
  3:`[00:35.00] हर पल मुस्कुराती है आँखें\n[00:42.00] किसकी हुई हैं ये बातें`
};
import { initPlayer } from './player.js';
import { renderRoute } from './ui.js';
import { registerSW } from 'https://unpkg.com/virtual-pwa@0.2';

document.addEventListener('DOMContentLoaded', () => {
  registerSW('./service-worker.js');      // offline & install prompt
  initPlayer();                           // wire audio + controls
  renderRoute('home');                    // first screen

  // bottom nav
  document.querySelectorAll('.nav-btn').forEach(btn =>
    btn.addEventListener('click', () => {
      document.querySelector('.nav-btn.active').classList.remove('active');
      btn.classList.add('active');
      renderRoute(btn.dataset.route);
    })
  );
});
import { songs } from './db.js';
import { loadSong, togglePlayer } from './player.js';

export function renderRoute(route) {
  const root = document.getElementById('root');
  switch (route) {
    case 'home':
      root.innerHTML = `
        <h1 class="greeting">Good Afternoon</h1>
        <section><h2>Top Hits</h2><div class="grid">${songs.map(card).join('')}</div></section>
      `;
      break;
    case 'search':
      root.innerHTML = `
        <input id="search-box" placeholder="What do you want to listen to?" autocomplete="off"/>
        <div id="search-results"></div>
      `;
      const box = document.getElementById('search-box');
      box.addEventListener('input', e => {
        const q = e.target.value.toLowerCase();
        const res = songs.filter(s => s.title.toLowerCase().includes(q) || s.artist.toLowerCase().includes(q));
        document.getElementById('search-results').innerHTML = res.map(list).join('');
      });
      break;
    case 'library':
      root.innerHTML = `<div class="list">${songs.map(list).join('')}</div>`;
      break;
  }
  root.querySelectorAll('[data-id]').forEach(el =>
    el.addEventListener('click', () => {
      const id = +el.dataset.id;
      loadSong(id);
      togglePlayer(true);
    })
  );
}

const card = s => `<div class="song-card" data-id="${s.id}"><img src="${s.artwork}" alt=""/><span>${s.title}</span><small>${s.artist}</small></div>`;
const list = s => `<div class="list-item" data-id="${s.id}"><img src="${s.artwork}"/><div><b>${s.title}</b><p>${s.artist}</p></div></div>`;
import { songs, lyrics } from './db.js';
const audio = document.getElementById('audio');
let index = 0;

export function initPlayer() {
  // transport controls
  ['play-pause','prev','next','shuffle','repeat'].forEach(id =>
    document.getElementById(id).addEventListener('click', e => controls(e.target.id))
  );
  document.getElementById('close-player').addEventListener('click', () => togglePlayer(false));
  document.getElementById('toggle-lyrics').addEventListener('click', () => {
    document.getElementById('lyrics-panel').hidden = false;
  });
  document.getElementById('close-lyrics').addEventListener('click', () => {
    document.getElementById('lyrics-panel').hidden = true;
  });

  // progress slider
  const progress = document.getElementById('progress');
  progress.addEventListener('input', () => audio.currentTime = progress.value);

  audio.addEventListener('loadedmetadata', () => progress.max = audio.duration);
  audio.addEventListener('timeupdate', () => {
    progress.value = audio.currentTime;
    document.getElementById('current').textContent = fmt(audio.currentTime);
  });
  audio.addEventListener('ended', next);
}

export function loadSong(id) {
  index = songs.findIndex(s => s.id === id);
  const s = songs[index];
  audio.src = s.audio;
  document.getElementById('player-art').src = s.artwork;
  document.getElementById('player-title').textContent = s.title;
  document.getElementById('player-artist').textContent = s.artist;
  document.getElementById('mini-art').src = s.artwork;
  document.getElementById('mini-title').textContent = s.title;
  document.getElementById('mini-artist').textContent = s.artist;
  document.getElementById('lyrics-text').textContent = lyrics[id] || 'Lyrics not available.';
  document.getElementById('duration').textContent = fmt(audio.duration || 0);
}

const fmt = t => `${~~(t/60)}:${(''+~~(t%60)).padStart(2,'0')}`;
const controls = id => {
  switch(id){
    case 'play-pause': audio.paused ? audio.play() : audio.pause(); break;
    case 'next': next(); break;
    case 'prev': prev(); break;
    case 'shuffle': /* TODO */ break;
    case 'repeat': /* TODO */ break;
  }
};
const next = () => { index = (index+1)%songs.length; loadSong(songs[index].id); audio.play(); };
const prev = () => { index = (index-1+songs.length)%songs.length; loadSong(songs[index].id); audio.play(); };

export function togglePlayer(show) {
  document.getElementById('player-overlay').hidden = !show;
  document.getElementById('mini-player').hidden = show;
}
